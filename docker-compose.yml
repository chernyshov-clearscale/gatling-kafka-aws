version: '2'
services:
  gatling-runner:
    # TODO should be parametrized
    image: 848625190772.dkr.ecr.us-east-2.amazonaws.com/distr-docke-flxqu317r5k1:latest
    command: -r org.izolotov.testing
    environment:
      - KEYS_PER_PRODUCER=10
      - PAYLOAD_SIZE_BYTES=50000
      - TOPIC_NAME=topic1
      - BOOTSTRAP_SERVERS=localhost:9092
      - MESSAGES_PER_SECOND=50000
      - DURATION_SECONDS=10
    ulimits:
      nproc: 65535
      nofile:
        soft: 65535
        hard: 65535
    logging:
      driver: awslogs
      options:
        awslogs-create-group: true
        awslogs-group: /ecs/gatling-runner
        # TODO should be parametrized
        awslogs-region: us-east-1
        awslogs-stream-prefix: gatling-runner
